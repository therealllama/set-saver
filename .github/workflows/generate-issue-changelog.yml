name: Generate Custom Issue Changelog

on:
  release:
    types:
      - created
      - published

jobs:
  build_changelog:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Run custom issue changelog builder
        uses: ./custom-issue-changelog
        with:
          repo: 'lodovicoazzini/set-saver' # If different repo, else omit
          label_config: |
            [
              {
                "label": "feature",
                "template": "- üöÄ $TITLE",
                "section_title": "Features"
              },
              {
                "label": "bug",
                "template": "- üêõ $TITLE",
                "section_title": "Bug Fixes"
              }
            ]
        env:
          # Provide REPO_B_TOKEN for fetching issues from repo B
          REPO_B_TOKEN: ${{ secrets.LODOVICOAZZINI_SETSAVER_READ_ISSUES }}
          # Provide GITHUB_TOKEN for editing the release in repo A (optional but explicit)
          GITHUB_TOKEN: ${{ secrets.THEREALLLAMA_SETSAVER_WRITE_CONTENT }}